---
title: "Webhook Pós-Chamada"
icon: "webhook"
description: "Webhook enviado após a conclusão de uma chamada contendo as variáveis extraídas e os dados da chamada "
---

O **Webhook Pós-Chamada** é enviado automaticamente para a URL do webhook especificada após a conclusão de cada chamada.\
Esse webhook contém os **detalhes da chamada**, as **variáveis extraídas**, a **transcrição** e, opcionalmente, o **URL da gravação**.

## Configuração de Webhook

Para habilitar os webhooks pós-chamada:

- Configure a **URL do webhook** do seu assistente nas configurações do assistente
- Ative a opção **"Post call webhook"** na configuração do assistente
- Defina as **variáveis pós-chamada** que a IA deve extrair

---

### **Formato da Requisição**

O webhook é enviado como uma **requisição POST** para a URL configurada, contendo o seguinte **payload JSON**:

### Estrutura do Payload

<ResponseField name="id" type="integer">
  Identificador único da chamada
</ResponseField>

<ResponseField name="customer_phone" type="string">
  Número de telefone do cliente no formato E.164 (ex: "+1234567890") ou _null_ se não disponível
</ResponseField>

<ResponseField name="assistant_phone" type="string">
  Número de telefone usado pelo assistente no formato E.164 ou _null_ se não disponível
</ResponseField>

<ResponseField name="duration" type="integer">
  Duração da chamada em segundos
</ResponseField>

<ResponseField name="status" type="string">
  Status final da chamada (ex: "completed", "busy", "failed")
</ResponseField>

<ResponseField name="extracted_variables" type="object">
  Variáveis extraídas pela IA com base na configuração do seu esquema pós-chamada

  <Expandable title="Examplo de Variáveis Extraídas">
    <ResponseField name="status" type="boolean">
      Indica se o objetivo da chamada foi alcançado
    </ResponseField>
    <ResponseField name="summary" type="string">
      Resumo da chamada em poucas palavras
    </ResponseField>
    <ResponseField name="custom_variable" type="string|number|boolean">
      Quaisquer variáveis personalizadas definidas na configuração do assistente
    </ResponseField>
  </Expandable>
</ResponseField>

<ResponseField name="input_variables" type="object">
  Variáveis que foram passadas para o assistente antes do início da chamada
</ResponseField>

<ResponseField name="transcript" type="string">
  Transcrição completa da conversa
</ResponseField>

<ResponseField name="recording_url" type="string">
  URL para download da gravação da chamada (incluído apenas se a opção "Include recording in webhook" estiver ativada nas configurações do assistente)
</ResponseField>

<ResponseField name="created_at" type="string">
  Timestamp em formato ISO 8601 indicando quando a chamada foi iniciada
</ResponseField>

<ResponseField name="finished_at" type="string">
  Timestamp em formato ISO 8601 indicando quando a chamada foi concluída (usa o campo _updated_at_ do registro da chamada)
</ResponseField>

<ResponseField name="lead" type="object">
  Informações do lead (incluídas apenas em chamadas de campanha)

  <Expandable title="Propriedades do Lead">
    <ResponseField name="id" type="integer">
      Identificador único do lead
    </ResponseField>
    <ResponseField name="phone_number" type="string">
      Número de telefone do lead
    </ResponseField>
    <ResponseField name="variables" type="object">
      Variáveis associadas ao lead
    </ResponseField>
    <ResponseField name="status" type="string">
      Status atual do lead
    </ResponseField>
    <ResponseField name="created_at" type="string">
      Data de criação do lead
    </ResponseField>
    <ResponseField name="updated_at" type="string">
      Data da última atualização do lead
    </ResponseField>
    <ResponseField name="campaign" type="object">
      Informações da campanha (se disponível)

      <Expandable title="Propriedades da Campanha">
        <ResponseField name="id" type="integer">
          ID da Campanha
        </ResponseField>
        <ResponseField name="name" type="string">
          Nome da Campanha
        </ResponseField>
        <ResponseField name="status" type="string">
          Status da Campanha
        </ResponseField>
        <ResponseField name="allowed_hours_start_time" type="string">
          Horário de início permitido da campanha
        </ResponseField>
        <ResponseField name="allowed_hours_end_time" type="string">
          Horário de término permitido da campanha
        </ResponseField>
        <ResponseField name="allowed_days" type="array">
          Dias permitidos para execução da campanha
        </ResponseField>
        <ResponseField name="max_calls_in_parallel" type="integer">
          Número máximo de chamadas simultâneas permitidas na campanha
        </ResponseField>
        <ResponseField name="max_retries" type="integer">
          Número máximo de tentativas de retorno para os leads
        </ResponseField>
        <ResponseField name="retry_interval" type="integer">
          Intervalo entre tentativas em minutos
        </ResponseField>
        <ResponseField name="created_at" type="string">
          Data de criação da campanha
        </ResponseField>
        <ResponseField name="updated_at" type="string">
          Data da última atualização da campanha
        </ResponseField>
      </Expandable>
    </ResponseField>
  </Expandable>
</ResponseField>

<ResponseExample>

```json 200 Post-Call Webhook Request
{
  "id": 12345,
  "customer_phone": "+1234567890",
  "assistant_phone": "+1987654321",
  "duration": 125,
  "status": "completed",
  "extracted_variables": {
    "status": true,
    "summary": "Customer interested in product demo",
    "lead_quality": "high",
    "next_action": "schedule_demo"
  },
  "input_variables": {
    "customer_name": "John Doe",
    "product_interest": "Pro Plan"
  },
  "transcript": [
    {
      "text": "Hello! This is Sarah from MayaHub. How are you today?",
      "type": "transcript",
      "sender": "bot",
      "timestamp": 1756812511.315143
    },
    {
      "text": "Hi, I'm doing well, thanks for calling.",
      "type": "transcript",
      "sender": "human",
      "timestamp": 1756812514.104436
    },
    {
      "text": "I'm calling to tell you about our new product features.",
      "type": "transcript",
      "sender": "bot",
      "timestamp": 1756812522.918859
    },
    {
      "text": "That sounds interesting, tell me more.",
      "type": "transcript",
      "sender": "human",
      "timestamp": 1756812525.234567
    }
  ],
  "formatted_transcript": "AI: Hello! This is Sarah from Autocalls. How are you today?\nCustomer: Hi, I'm doing well, thanks for calling.\nAI: I'm calling to tell you about our new product features.\nCustomer: That sounds interesting, tell me more.",
  "recording_url": "https://app.mayahub.ai/storage/recordings/call-12345.mp4",
  "created_at": "2025-01-15T10:30:00.000000Z",
  "finished_at": "2025-01-15T10:32:05.000000Z",
  "lead": {
    "id": 789,
    "phone_number": "+1234567890",
    "variables": {
      "source": "website",
      "interest_level": "high"
    },
    "status": "contacted",
    "created_at": "2025-01-15T09:00:00.000000Z",
    "updated_at": "2025-01-15T10:32:05.000000Z",
    "campaign": {
      "id": 456,
      "name": "Product Demo Campaign",
      "status": "active",
      "allowed_hours_start_time": "09:00",
      "allowed_hours_end_time": "17:00",
      "allowed_days": ["monday", "tuesday", "wednesday", "thursday", "friday"],
      "max_calls_in_parallel": 5,
      "max_retries": 3,
      "retry_interval": 60,
      "created_at": "2025-01-15T08:00:00.000000Z",
      "updated_at": "2025-01-15T08:00:00.000000Z"
    }
  }
}
```

</ResponseExample>

## Configurações de Webhook

Você pode configurar as seguintes opções para o seu webhook pós-chamada:

- **Send webhook only on completed:** Envia o webhook apenas para chamadas concluídas com sucesso
- **Include recording in webhook:** Inclui o campo _recording_url_ no payload
- **Custom variables:** Define variáveis personalizadas que a IA deve extrair da conversa

---

### Notas Importantes

- Os campos _customer_phone_ e _assistant_phone_ podem ser _null_ se as informações não estiverem disponíveis
- O campo _recording_url_ só é incluído se a opção **"Include recording in webhook"** estiver ativada nas configurações do seu assistente
- O objeto _lead_ só é incluído em chamadas que fazem parte de uma campanha
- O objeto _extracted_variables_ conterá as variáveis definidas na configuração do esquema pós-chamada do seu assistente